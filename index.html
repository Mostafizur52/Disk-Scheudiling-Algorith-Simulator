<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Disk Scheduling Algorithm Simulator</title>
  <style>
    :root{
      --bg:#0b1020; --card:#12182b; --muted:#9fb1c1; --text:#e9f0f7; --accent:#60a5fa; --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter, system-ui,-apple-system, Segoe UI, Roboto, Arial, sans-serif; background:radial-gradient(1200px 600px at 80% -10%, rgba(96,165,250,.25), transparent), linear-gradient(180deg, #0b1020, #0b1020 60%, #0a0f1a); color:var(--text)}
    .container{max-width:1100px; margin:32px auto; padding:0 16px}
    h1{margin:0 0 8px; font-size:28px; font-weight:800; letter-spacing:.2px}
    .chip{font-size:12px; padding:4px 8px; background:#1d2541; border:1px solid #2a355e; border-radius:999px; color:var(--muted)}

    .grid{display:grid; grid-template-columns:1.1fr .9fr; gap:20px}
    @media (max-width:1000px){.grid{grid-template-columns:1fr}}

    .card{background:linear-gradient(180deg, #12182b, #0f1526); border:1px solid #233052; border-radius:18px; box-shadow:0 10px 30px rgba(0,0,0,.35); padding:18px}
    .card h3{margin:0 0 10px; font-size:16px; color:#cfe0f0; font-weight:700}

    label{font-size:12px; color:var(--muted)}
    input, select, textarea{width:100%; padding:12px; border-radius:12px; background:#0b1224; border:1px solid #223055; color:var(--text); outline:none}
    input:focus, select:focus, textarea:focus{border-color:var(--accent); box-shadow:0 0 0 3px rgba(96,165,250,.15)}
    .row{display:grid; grid-template-columns:repeat(2,1fr); gap:12px}
    .row-3{display:grid; grid-template-columns:repeat(3,1fr); gap:12px}
    .row-4{display:grid; grid-template-columns:repeat(4,1fr); gap:12px}

    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px; background:#1a2344; color:#cfe0f0; border:1px solid #2a355e; cursor:pointer}
    .btn:hover{border-color:#36539a}
    .btn.secondary{background:#0f152a}
    .btnbar{display:flex; gap:10px; flex-wrap:wrap}

    .muted{color:var(--muted); font-size:13px}
    .stat{display:flex; gap:14px; flex-wrap:wrap; margin-top:10px}
    .pill{padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid #2a355e; background:#0a1226}

    /* chart */
    .chart-wrap{position:relative; height:360px; background:#0b1224; border:1px solid #223055; border-radius:14px; padding:12px}
    svg{width:100%; height:100%}
    .legend{display:flex; gap:10px; flex-wrap:wrap; font-size:12px; color:var(--muted); margin-top:8px}
    .legend .box{display:inline-block; width:12px; height:12px; border-radius:3px; margin-right:6px}

    table{width:100%; border-collapse:collapse; font-size:13px}
    th, td{padding:10px; border-bottom:1px dashed #27345b}
    th{color:#cfe0f0; text-align:left}

    .footer{margin-top:10px; font-size:12px; color:var(--muted)}
    
    /* Head movement sequence */
    .sequence-container {margin-top: 20px; overflow-x: auto}
    .sequence-title {font-size: 16px; margin-bottom: 10px; color: #cfe0f0; font-weight: 700}
    .sequence {display: flex; gap: 8px; padding: 10px 0; align-items: center}
    .sequence-step {position: relative; display: flex; flex-direction: column; align-items: center; min-width: 60px}
    .sequence-track {width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; background: #1a2344; border: 2px solid #2a355e; transition: all 0.3s ease}
    .sequence-track.start {background: #f59e0b; border-color: #fbbf24}
    .sequence-track.request {background: #22c55e; border-color: #4ade80}
    .sequence-track.current {box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.5)}
    .sequence-index {font-size: 11px; color: var(--muted); margin-top: 4px}
    .sequence-arrow {font-size: 18px; color: #60a5fa; margin: 0 5px}
    .sequence-controls {display: flex; gap: 10px; margin-top: 15px; align-items: center}
    .sequence-btn {padding: 6px 12px; border-radius: 6px; background: #1a2344; color: #cfe0f0; border: 1px solid #2a355e; cursor: pointer; font-size: 12px}
    .sequence-btn:hover {border-color: #36539a}
    .sequence-btn:disabled {opacity: 0.5; cursor: not-allowed}
    .sequence-speed {display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--muted)}
    .sequence-speed input {width: 120px; padding: 4px}
  </style>
</head>
<body>
  <div class="container">
    <h1>Disk Scheduling Simulator <span class="chip">FCFS ‚Ä¢ SSTF ‚Ä¢ SCAN ‚Ä¢ C‚ÄëSCAN ‚Ä¢ LOOK ‚Ä¢ C‚ÄëLOOK</span></h1>

    <div class="grid">
      <!-- Controls -->
      <div class="card">
        <h3>Inputs</h3>
        <div class="row-3" style="margin-bottom:12px">
          <div>
            <label for="requests">Requests (comma/space)</label>
            <input id="requests" placeholder="e.g., 98, 183, 37 122 14 124 65 67" />
          </div>
          <div>
            <label for="head">Initial Head</label>
            <input id="head" type="number" min="0" value="53" />
          </div>
          <div>
            <label for="maxCyl">Max Cylinder (last index)</label>
            <input id="maxCyl" type="number" min="10" value="199" />
          </div>
        </div>
        <div class="row-3" style="margin-bottom:12px">
          <div>
            <label for="algo">Algorithm</label>
            <select id="algo">
              <option>FCFS</option>
              <option>SSTF</option>
              <option>SCAN</option>
              <option>C-SCAN</option>
              <option>LOOK</option>
              <option>C-LOOK</option>
            </select>
          </div>
          <div>
            <label for="direction">Direction</label>
            <select id="direction">
              <option value="up">Up (toward higher tracks)</option>
              <option value="down">Down (toward lower tracks)</option>
            </select>
          </div>
          <div>
            <label>&nbsp;</label>
            <div class="btnbar">
              <button class="btn" id="runBtn">‚ñ∂ Run</button>
              <button class="btn secondary" id="randomBtn">üé≤ Random</button>
              <button class="btn secondary" id="resetBtn">‚Ü∫ Reset</button>
            </div>
          </div>
        </div>
        <div class="muted">Tip: Direction matters for SCAN/LOOK variants. "Max Cylinder" is the highest track index (0..N).</div>
        <div class="stat">
          <span class="pill">Total movement: <strong id="totalMove">‚Äî</strong></span>
          <span class="pill">Sequence length: <strong id="seqLen">‚Äî</strong></span>
        </div>
      </div>

      <!-- Visualization -->
      <div class="card">
        <h3>Head Path</h3>
        <div class="chart-wrap">
          <svg id="chart" viewBox="0 0 1000 320" preserveAspectRatio="none" aria-label="chart"></svg>
        </div>
        <div class="legend">
          <span><span class="box" style="background:#60a5fa"></span>Path</span>
          <span><span class="box" style="background:#22c55e"></span>Serviced Request</span>
          <span><span class="box" style="background:#f59e0b"></span>Head Start</span>
          <span><span class="box" style="background:#9fb1c1"></span>Track Axis</span>
        </div>
      </div>
    </div>

    <!-- Head Movement Sequence -->
    <div class="card" style="margin-top:20px">
      <h3>Head Movement Sequence</h3>
      <div class="sequence-container">
        <div class="sequence" id="sequence"></div>
        <div class="sequence-controls">
          <button class="sequence-btn" id="playBtn">‚ñ∂ Play</button>
          <button class="sequence-btn" id="pauseBtn" disabled>‚è∏ Pause</button>
          <button class="sequence-btn" id="resetSequenceBtn">‚Ü∫ Reset</button>
          <button class="sequence-btn" id="prevBtn">‚èÆ Previous</button>
          <button class="sequence-btn" id="nextBtn">‚è≠ Next</button>
          <div class="sequence-speed">
            <span>Speed:</span>
            <input type="range" id="speedControl" min="1" max="10" value="5">
          </div>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:20px">
      <h3>Service Order</h3>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Track</th>
            <th>Move From</th>
            <th>Move To</th>
            <th>Distance</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <tr><td colspan="5" class="muted">Run an algorithm to see results.</td></tr>
        </tbody>
      </table>
      <div class="footer">All algorithms assume a single-arm disk with one request serviced at a time.</div>
    </div>
  </div>

  <script>
    // ---------- Helpers ----------
    const $ = (id)=>document.getElementById(id);
    const requestsEl = $('requests');
    const headEl = $('head');
    const maxEl = $('maxCyl');
    const algoEl = $('algo');
    const dirEl = $('direction');
    const runBtn = $('runBtn');
    const resetBtn = $('resetBtn');
    const randomBtn = $('randomBtn');
    const totalMoveEl = $('totalMove');
    const seqLenEl = $('seqLen');
    const tableBody = $('tableBody');
    const chart = $('chart');
    const sequenceEl = $('sequence');
    const playBtn = $('playBtn');
    const pauseBtn = $('pauseBtn');
    const resetSequenceBtn = $('resetSequenceBtn');
    const prevBtn = $('prevBtn');
    const nextBtn = $('nextBtn');
    const speedControl = $('speedControl');

    // Animation state
    let animationInterval = null;
    let currentStep = 0;
    let sequenceData = [];

    function parseList(str){
      return (str||'')
        .split(/[^\d]+/)
        .filter(Boolean)
        .map(Number);
    }

    function clamp(n,min,max){return Math.min(Math.max(n,min),max)}

    function sumAbsDiff(seq, start){
      let cur = start, total = 0; const steps=[];
      for (const x of seq){ const d = Math.abs(x - cur); steps.push({from:cur,to:x,dist:d}); total += d; cur = x; }
      return {total, steps};
    }

    // ---------- Algorithms ----------
    function fcfs(reqs){ return reqs.slice(); }

    function sstf(reqs, start){
      const left = reqs.slice(); const out=[]; let cur=start;
      while(left.length){
        let idx=0, best=Infinity;
        for(let i=0;i<left.length;i++){ const d=Math.abs(left[i]-cur); if(d<best){best=d; idx=i;} }
        const next = left.splice(idx,1)[0]; out.push(next); cur=next;
      }
      return out;
    }

    function scan(reqs, start, maxCyl, dir){
      const lower = reqs.filter(r=>r<start).sort((a,b)=>a-b);
      const higher = reqs.filter(r=>r>=start).sort((a,b)=>a-b);
      const up = dir==='up';
      if(up){
        const seq = higher.concat([maxCyl], lower.slice().reverse());
        // remove maxCyl if it wasn't requested
        return seq.filter((x,i)=> i===0 || seq[i-1]!==x).filter(x=> x===maxCyl || reqs.includes(x));
      } else {
        const seq = lower.slice().reverse().concat([0], higher);
        return seq.filter((x,i)=> i===0 || seq[i-1]!==x).filter(x=> x===0 || reqs.includes(x));
      }
    }

    function cscan(reqs, start, maxCyl, dir){
      const lower = reqs.filter(r=>r<start).sort((a,b)=>a-b);
      const higher = reqs.filter(r=>r>=start).sort((a,b)=>a-b);
      const up = dir==='up';
      if(up){
        // go up to max, wrap to 0, continue up
        const seq = higher.concat([maxCyl, 0], lower);
        return seq.filter(x=> x===maxCyl || x===0 || reqs.includes(x));
      } else {
        // go down to 0, wrap to max, continue down
        const seq = lower.slice().reverse().concat([0, maxCyl], higher.slice().reverse());
        return seq.filter(x=> x===0 || x===maxCyl || reqs.includes(x));
      }
    }

    function look(reqs, start, _max, dir){
      const lower = reqs.filter(r=>r<start).sort((a,b)=>a-b);
      const higher = reqs.filter(r=>r>=start).sort((a,b)=>a-b);
      const up = dir==='up';
      return up ? higher.concat(lower.slice().reverse())
                : lower.slice().reverse().concat(higher);
    }

    function clook(reqs, start, _max, dir){
      const lower = reqs.filter(r=>r<start).sort((a,b)=>a-b);
      const higher = reqs.filter(r=>r>=start).sort((a,b)=>a-b);
      const up = dir==='up';
      return up ? higher.concat(lower)
                : lower.slice().reverse().concat(higher.slice().reverse());
    }

    const algoMap = {
      'FCFS': (reqs,start,max,dir)=>fcfs(reqs),
      'SSTF': (reqs,start,max,dir)=>sstf(reqs,start),
      'SCAN': (reqs,start,max,dir)=>scan(reqs,start,max,dir),
      'C-SCAN': (reqs,start,max,dir)=>cscan(reqs,start,max,dir),
      'LOOK': (reqs,start,max,dir)=>look(reqs,start,max,dir),
      'C-LOOK': (reqs,start,max,dir)=>clook(reqs,start,max,dir)
    };

    // ---------- Rendering ----------
    function renderTable(seq, start){
      tableBody.innerHTML='';
      const {total,steps} = sumAbsDiff(seq, start);
      totalMoveEl.textContent = total;
      seqLenEl.textContent = seq.length;
      if(!steps.length){ tableBody.innerHTML='<tr><td colspan="5" class="muted">No requests to service.</td></tr>'; return; }
      steps.forEach((s,i)=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${i+1}</td><td>${s.to}</td><td>${s.from}</td><td>${s.to}</td><td>${s.dist}</td>`;
        tableBody.appendChild(tr);
      });
    }

    function renderChart(seq, start, maxCyl){
      // SVG coords: x -> track (0..maxCyl) mapped to 40..960, y -> step index 20..300
      const padL=40, padR=40, padT=20, padB=20;
      const xScale = (v)=> padL + (v/maxCyl) * (1000 - padL - padR);
      const yScale = (i)=> padT + (i/(Math.max(1,seq.length))) * (320 - padT - padB);
      const axisY = yScale(0);

      const points = [start, ...seq];
      let path = '';
      for(let i=0;i<points.length;i++){
        const x = xScale(points[i]);
        const y = yScale(i);
        path += (i===0?`M ${x},${y}`:` L ${x},${y}`);
      }

      // Build SVG content
      const ticks = 10;
      let grid = '';
      for(let t=0;t<=ticks;t++){
        const val = Math.round((t/ticks)*maxCyl);
        const x = xScale(val);
        grid += `<line x1="${x}" y1="${padT}" x2="${x}" y2="${320-padB}" stroke="#2a355e" stroke-dasharray="4 4" />`+
                `<text x="${x}" y="${320-4}" fill="#9fb1c1" font-size="10" text-anchor="middle">${val}</text>`;
      }

      const circles = seq.map((v,i)=>{
        const x=xScale(v), y=yScale(i+1);
        return `<circle cx="${x}" cy="${y}" r="4" fill="#22c55e" />`;
      }).join('');

      const startDot = `<circle cx="${xScale(start)}" cy="${yScale(0)}" r="5" fill="#f59e0b" />`;

      chart.innerHTML = `
        <rect x="0" y="0" width="1000" height="320" fill="transparent" />
        ${grid}
        <path d="${path}" fill="none" stroke="#60a5fa" stroke-width="2.5" />
        ${startDot}
        ${circles}
      `;
    }

    // ---------- Head Movement Sequence ----------
    function renderSequence(seq, start) {
      sequenceEl.innerHTML = '';
      sequenceData = [start, ...seq];
      currentStep = 0;
      
      sequenceData.forEach((track, index) => {
        const stepEl = document.createElement('div');
        stepEl.className = 'sequence-step';
        
        const trackEl = document.createElement('div');
        trackEl.className = 'sequence-track';
        if (index === 0) {
          trackEl.classList.add('start');
        } else {
          trackEl.classList.add('request');
        }
        trackEl.textContent = track;
        
        const indexEl = document.createElement('div');
        indexEl.className = 'sequence-index';
        indexEl.textContent = index === 0 ? 'Start' : `Step ${index}`;
        
        stepEl.appendChild(trackEl);
        stepEl.appendChild(indexEl);
        sequenceEl.appendChild(stepEl);
        
        // Add arrow between steps (except after the last one)
        if (index < sequenceData.length - 1) {
          const arrow = document.createElement('div');
          arrow.className = 'sequence-arrow';
          arrow.textContent = '‚Üí';
          sequenceEl.appendChild(arrow);
        }
      });
      
      updateSequenceHighlight();
    }
    
    function updateSequenceHighlight() {
      const tracks = sequenceEl.querySelectorAll('.sequence-track');
      tracks.forEach((track, index) => {
        track.classList.remove('current');
        if (index === currentStep) {
          track.classList.add('current');
        }
      });
      
      // Enable/disable navigation buttons
      prevBtn.disabled = currentStep === 0;
      nextBtn.disabled = currentStep === sequenceData.length - 1;
    }
    
    function playSequence() {
      pauseSequence(); // Clear any existing interval
      
      const speed = 1100 - (speedControl.value * 100); // 100ms to 1000ms
      
      animationInterval = setInterval(() => {
        if (currentStep < sequenceData.length - 1) {
          currentStep++;
          updateSequenceHighlight();
        } else {
          pauseSequence();
        }
      }, speed);
      
      playBtn.disabled = true;
      pauseBtn.disabled = false;
    }
    
    function pauseSequence() {
      if (animationInterval) {
        clearInterval(animationInterval);
        animationInterval = null;
      }
      
      playBtn.disabled = false;
      pauseBtn.disabled = true;
    }
    
    function resetSequence() {
      pauseSequence();
      currentStep = 0;
      updateSequenceHighlight();
    }
    
    function nextStep() {
      pauseSequence();
      if (currentStep < sequenceData.length - 1) {
        currentStep++;
        updateSequenceHighlight();
      }
    }
    
    function prevStep() {
      pauseSequence();
      if (currentStep > 0) {
        currentStep--;
        updateSequenceHighlight();
      }
    }

    // ---------- Run ----------
    function run(){
      const reqs = parseList(requestsEl.value);
      const maxCyl = Math.max(1, Number(maxEl.value)||199);
      const start = clamp(Number(headEl.value)||0, 0, maxCyl);
      const algo = algoEl.value;
      const dir = dirEl.value;

      // filter out-of-range
      const inRange = reqs.filter(r=> r>=0 && r<=maxCyl && r!==start);
      const seq = (algoMap[algo]||fcfs)(inRange, start, maxCyl, dir);

      renderTable(seq, start);
      renderChart(seq, start, maxCyl);
      renderSequence(seq, start);
    }

    function reset(){
      requestsEl.value = '';
      headEl.value = '53';
      maxEl.value = '199';
      algoEl.value = 'FCFS';
      dirEl.value = 'up';
      totalMoveEl.textContent = '‚Äî';
      seqLenEl.textContent = '‚Äî';
      tableBody.innerHTML = '<tr><td colspan="5" class="muted">Run an algorithm to see results.</td></tr>';
      chart.innerHTML = '';
      sequenceEl.innerHTML = '';
      pauseSequence();
    }

    function randomize(){
      const maxCyl = Math.max(100, Number(maxEl.value)||199);
      const n = 8 + Math.floor(Math.random()*7); // 8..14
      const reqs = new Set();
      while(reqs.size < n){ reqs.add(Math.floor(Math.random()*(maxCyl+1))); }
      const arr = Array.from(reqs);
      const start = arr.splice(Math.floor(Math.random()*arr.length),1)[0];
      headEl.value = start;
      requestsEl.value = arr.join(', ');
    }

    // Event listeners
    runBtn.addEventListener('click', run);
    resetBtn.addEventListener('click', reset);
    randomBtn.addEventListener('click', randomize);
    
    // Sequence controls
    playBtn.addEventListener('click', playSequence);
    pauseBtn.addEventListener('click', pauseSequence);
    resetSequenceBtn.addEventListener('click', resetSequence);
    prevBtn.addEventListener('click', prevStep);
    nextBtn.addEventListener('click', nextStep);
    speedControl.addEventListener('input', () => {
      if (animationInterval) {
        pauseSequence();
        playSequence();
      }
    });

    // Initialize
    reset();
  </script>
</body>
</html>
